<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Mastering C++ for scientific computing: tools, tips, and tricks</title>

    <meta name="description"
        content="Thanks to its impressive performance and its unrivaled abstraction power, C++ remains one of the most widely used languages in scientific computing: It lies at the core of machine learning frameworks like TensorFlow and PyTorch, is the foundation of vendor-specific tools for programming accelerators like SYCL, NVIDIA's CUDA or AMD's HIP, and is the go-to language for scientific and engineering projects spanning the full spectrum from tiny embedded control applications, all the way up to analyzing the petabytes of data generated by physics experiments at CERN. This seminar will cover tools and guidelines to help you to efficiently develop safer, more performant, and more maintainable C++ code. We will go over the following topics: development tools, runtime sanitizers and static analysis, C++ Core Guidelines, the pitfalls of undefined behavior, build systems and packaging, portability and compatibility, interfacing with Python, performance, linear algebra ... The main goal is to cover a broad range of topics, and provide pointers to further resources to dive into. While aimed primarily towards PhD researchers and students who use C++ in their research or master's thesis, the talk should provide valuable insights for anyone with an interest in C++.">
    <meta name="author" content="Pieter Pas">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="node_modules/reveal.js/dist/reset.css">
    <link rel="stylesheet" href="node_modules/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="node_modules/reveal.js/dist/theme/serif.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="node_modules/reveal.js/plugin/highlight/monokai.css">

    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section>
                <h3>Mastering C++ for scientific computing:<br>tools, tips, and tricks</h3>
                <hr>
                <p>
                    <small><a href="https://github.com/tttapa">Pieter Pas</a></small>
                </p>
            </section>

            <section class="full">
                <h3>Outline</h3>
                <hr>
                <ol style="margin-top: 1.5em;">
                    <li><a style="font-family: inherit;" href="#/sec-devtools">Development tools</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-example">Building an example project</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-cmake">CMake concepts</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-pkg">Package management</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-bugs">Catching bugs early</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-practices">Best practices</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-optimization">Optimization</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-interop">Interoperability with Python</a></li>
                    <li><a style="font-family: inherit;" href="#/sec-rsrc">Useful resources</a></li>
                </ol>
            </section>

            <section>
                <section id="sec-devtools">
                    <h3>Development tools</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>Compilers</h4>
                    <hr>
                    <ul>
                        <li><b>Linux</b>
                            <ul>
                                <li>GCC <small class="rmrk">(<code>sudo apt install g++</code>)&emsp;(<a
                                            href="https://launchpad.net/~ubuntu-toolchain-r/+archive/ubuntu/test">ppa:ubuntu-toolchain-r/test</a>)</small>
                                </li>
                                <li>Clang <small class="rmrk">(<code>sudo apt install clang</code>)&emsp;(<a
                                            href="https://apt.llvm.org">apt.llvm.org</a>)</small></li>
                            </ul>
                        </li>
                        <li><b>macOS</b>
                            <ul>
                                <li>Apple Clang <small class="rmrk">(<a
                                            href="https://developer.apple.com/xcode">developer.apple.com/xcode</a>)</small>
                                </li>
                                <li>Clang <small class="rmrk">(<code>brew install llvm</code>)</small></li>
                                <li>GCC <small class="rmrk">(<code>brew install gcc</code>)</small></li>
                            </ul>
                        </li>
                        <li><b>Windows</b>
                            <ul>
                                <li>MSVC <small class="rmrk">(<a
                                            href="https://visualstudio.microsoft.com">visualstudio.microsoft.com</a>)</small>
                                </li>
                                <li><s>MinGW</s> <small class="rmrk">(not recommended)</small></li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Compilers</h4>
                    <hr>
                    <ul>
                        <li><b>Intel</b>
                            <ul>
                                <li>Intel oneAPI DPC++/C++ Compiler <br><small class="rmrk">(<a
                                            href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/dpc-compiler.html">www.intel.com/content/www/us/en/developer/tools/oneapi/dpc-compiler.html</a>)</small>
                                </li>
                            </ul>
                        </li>
                        <li><b>AMD</b>
                            <ul>
                                <li>AMD Optimizing C++ Compiler <br><small class="rmrk">(<a
                                            href="https://www.amd.com/en/developer/aocc.html">www.amd.com/en/developer/aocc.html</a>)</small>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Integrated development environments (IDEs)</h4>
                    <hr>
                    <ul>
                        <li><b>Visual Studio</b> <small class="rmrk">(Windows only)</small></li>
                        <li><b>Xcode</b> <small class="rmrk">(macOS only)</small></li>
                        <li><b>Clion</b> <small class="rmrk">(€12/month, free student license)</small></li>
                        <li><b>Visual Studio Code</b>
                            <ul>
                                <li><em>C/C++ extension</em></li>
                                <li><em>Clangd extension</em></li>
                                <li><em>CMake Tools extension</em></li>
                            </ul>
                        </li>
                        <li><b>Other editors</b>
                            <ul>
                                <li><em>Clangd language server</em></li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Integrated development environments (IDEs): Go to definition</h4>
                    <video data-autoplay loop src="media/goto-definition.mp4"></video>
                </section>
                <section class="full">
                    <h4>Integrated development environments (IDEs): Refactoring</h4>
                    <video data-autoplay loop src="media/refactor.mp4"></video>
                </section>
                <section class="full">
                    <h4>Integrated development environments (IDEs): Warnings and static analysis
                    </h4>
                    <video data-autoplay loop src="media/clang-tidy.mp4"></video>
                </section>
                <section class="full">
                    <h4>Integrated development environments (IDEs): Debugging</h4>
                    <video data-autoplay loop src="media/debug.mp4"></video>
                </section>
                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li>Locate <span class="alert">compiler</span> and other tools</li>
                        <li>Detect compiler <span class="alert">features</span></li>
                        <li>Allow configuration of project <span class="alert">options</span></li>
                        <li>Locate <span class="alert">dependencies</span></li>
                        <li>Propagate compiler and linker <span class="alert">flags</span></li>
                        <li>Drive the <span class="alert">build</span> process</li>
                        <li><span class="alert">Install</span> resulting binaries</li>
                        <li><span class="alert">Package</span> resulting binaries</li>
                        <li>Drive <span class="alert">test</span> runners</li>
                    </ul>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Build system generators: example</h4>
                    <hr>
                    <pre data-id="code-animation"><code class="hljs bash" data-trim data-line-numbers="|1-2|3-4|5-6|7-8"><script type="text/template">
                        # Download a handy text formatting library as an example
                        git clone https://github.com/fmtlib/fmt --branch 10.1.1 --single-branch --depth 1
                        # Configure the project using CMake
                        cmake -S fmt -B fmt/build -G "Ninja Multi-Config" -D FMT_TEST=Off
                        # Build the project using CMake
                        cmake --build fmt/build --config Release -j
                        # Install the project using CMake
                        cmake --install fmt/build --config Release --prefix="$HOME/opt/fmt-10.1.1"
                    </script></code></pre>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Build system generators: example</h4>
                    <hr>
                    <pre data-id="code-animation"><code class="hljs bash" data-trim data-line-numbers="1-13|15-18|19-39"><script type="text/template">
                        cmake -S fmt -B fmt/build -G "Ninja Multi-Config" -D FMT_TEST=Off
                        -- CMake version: 3.27.1
                        -- The CXX compiler identification is GNU 11.4.0
                        -- Detecting CXX compiler ABI info
                        -- Detecting CXX compiler ABI info - done
                        -- Check for working CXX compiler: /usr/bin/c++ - skipped
                        -- Detecting CXX compile features
                        -- Detecting CXX compile features - done
                        -- Version: 10.1.0
                        -- Build type: Release
                        -- Configuring done (0.4s)
                        -- Generating done (0.0s)
                        -- Build files have been written to: /tmp/fmt/build

                        cmake --build fmt/build --config Release -j
                        [1/3] Building CXX object CMakeFiles/fmt.dir/Release/src/os.cc.o
                        [2/3] Building CXX object CMakeFiles/fmt.dir/Release/src/format.cc.o
                        [3/3] Linking CXX static library Release/libfmt.a

                        cmake --install fmt/build --config Release --prefix="$HOME/opt/fmt-10.1.1"
                        -- Installing: ~/opt/fmt-10.1.1/lib/libfmt.a
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/args.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/chrono.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/color.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/compile.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/core.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/format.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/format-inl.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/os.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/ostream.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/printf.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/ranges.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/std.h
                        -- Installing: ~/opt/fmt-10.1.1/include/fmt/xchar.h
                        -- Installing: ~/opt/fmt-10.1.1/lib/cmake/fmt/fmt-config.cmake
                        -- Installing: ~/opt/fmt-10.1.1/lib/cmake/fmt/fmt-config-version.cmake
                        -- Installing: ~/opt/fmt-10.1.1/lib/cmake/fmt/fmt-targets.cmake
                        -- Installing: ~/opt/fmt-10.1.1/lib/cmake/fmt/fmt-targets-release.cmake
                        -- Installing: ~/opt/fmt-10.1.1/lib/pkgconfig/fmt.pc
                    </script></code></pre>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>CMake</b> <small class="rmrk">(<code>CMakeLists.txt</code>)</small>
                            <ul class="plus fragment">
                                <li>De facto standard</li>
                                <li>Huge ecosystem, loads of online resources</li>
                                <li>Compatible with all major IDEs and toolchains</li>
                                <li>Fast</li>
                                <li>Flexible</li>
                                <li>Interoperability with package managers</li>
                                <li>Supports testing and packaging</li>
                                <li>Easy to use for users of your project</li>
                            </ul>
                            <ul class="min fragment">
                                <li>Awkward syntax</li>
                                <li>Lots of poorly written legacy CMake code</li>
                            </ul>
                            <ul class="arrow fragment">
                                <li>If you are going to learn one build system, learn CMake</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>Meson</b> <small class="rmrk">(<code>meson.build</code>)</small>
                            <ul class="plus">
                                <li>Declarative syntax</li>
                                <li>Intuitive command line interface</li>
                                <li>Fast</li>
                                <li>Gaining popularity</li>
                                <li>Not turing complete</li>
                            </ul>
                            <ul class="min">
                                <li>Not turing complete</li>
                                <li>Smaller community compared to CMake</li>
                                <li>Requires Python</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>Bazel</b> <small class="rmrk">(<code>BUILD</code>)</small>
                            <ul class="plus">
                                <li>Scalable to very large projects</li>
                                <li>Remote building, caching and testing</li>
                                <li>Arguably simpler syntax compared to CMake</li>
                            </ul>
                            <ul class="min">
                                <li>Developed by Google for Google</li>
                                <li>Poor Windows support</li>
                                <li>Painful dependency management</li>
                                <li>Requires Java</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>SCons</b> <small class="rmrk">(<code>SConstruct</code>)</small>
                            <ul class="plus">
                                <li>Extensible</li>
                                <li>Reproducible</li>
                            </ul>
                            <ul class="min">
                                <li>Very slow</li>
                                <li>No package detection</li>
                                <li>Very poor/nonexistent cross-compilation support</li>
                                <li>Low-level, no transitive options</li>
                                <li>Lots of manual plumbing</li>
                                <li>Requires creating a custom, one-off build system</li>
                                <li>Requires Python</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>Xmake</b> <small class="rmrk">(<code>xmake.lua</code>)</small>
                            <ul class="plus">
                                <li>Many features and many supported backends</li>
                                <li>Built-in package manager compatible with external repositories</li>
                            </ul>
                            <ul class="min">
                                <li>Quite new</li>
                                <li>Mostly a single-developer effort</li>
                                <li>Most of the discussions and issues are in Chinese</li>
                                <li>“Everything but the kitchen sink”</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system generators</h4>
                    <hr>
                    <ul>
                        <li><b>GNU Autotools</b> <small class="rmrk">(<code>autogen.sh</code>,
                                <code>configure.sh</code>)</small>
                            <ul class="plus">
                                <li>Many older GNU/Linux projects use it</li>
                            </ul>
                            <ul class="min">
                                <li>Outdated</li>
                                <li>Primitive and fragile dependency detection <small class="rmrk">(manual or
                                        <code>pkg-config</code>)</small></li>
                                <li>Poor macOS and Windows compatibility</li>
                                <li>Very slow</li>
                                <li>Hard to understand, debug or patch</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system <span class="fragment strike">generators</span></h4>
                    <hr>
                    <ul>
                        <li><b>Make</b> <small class="rmrk">(<code>Makefile</code>)</small>
                            <ul class="plus">
                                <li>Many older Linux projects use it</li>
                                <li>Available as CMake or Autotools backend</li>
                            </ul>
                            <ul class="min">
                                <li>Very low-level build rules</li>
                                <li>Not a build system generator (no dependency or compiler detection etc.)</li>
                                <li>Cryptic syntax</li>
                                <li>Static recipes</li>
                                <li>Does not allow spaces in paths</li>
                                <li>Primitive timestamp-based checks</li>
                                <li>Manual dependency generation</li>
                                <li>Poor Windows compatibility</li>
                                <li>Not portable</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Build system <s>generators</s></h4>
                    <hr>
                    <ul>
                        <li><b>Ninja</b> <small class="rmrk">(<code>build.ninja</code>)</small>
                            <ul class="plus">
                                <li>A more modern Make alternative</li>
                                <li>Fast, easy multi-threading</li>
                                <li>Light-weight stand-alone binary</li>
                                <li>Support for C++ and Fortran modules</li>
                                <li>Excellent backend for CMake</li>
                            </ul>
                            <ul class="min">
                                <li>Intended for code generation by a higher-level tool like CMake</li>
                            </ul>
                            <ul class="arrow fragment">
                                <li>Ideal CMake backend on Linux and macOS <small class="rmrk">(use VS on
                                        Windows)</small>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <pre class="fragment" style="width:68%"><code class="hljs bash" data-trim data-line-numbers><script type="text/template">
                        cmake -S fmt -B fmt/build -G "Ninja Multi-Config" -D FMT_TEST=Off</script></code></pre>
                </section>
            </section>

            <section>
                <section id="sec-example">
                    <h3>Building an example project</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <pre><code class="hljs text" data-trim data-line-numbers="|2-9|3-6|7-8|9|10-12|13" data-noescape>
                        poly
                          ├── src                             -- library source code
                          │   ├── include                         -- public API header files
                          │   │   └── poly
                          │   │       ├── interpolate.hpp
                          │   │       └── poly.hpp
                          │   ├── src                             -- implementation files
                          │   │   └── interpolate.cpp
                          │   └── CMakeLists.txt                  -- library build script
                          ├── test                            -- unit tests
                          │   ├── CMakeLists.txt                  -- testing framework build script
                          │   └── test-interpolate.cpp
                          └── CMakeLists.txt                  -- user-facing build script</code></pre>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="13">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cmake" data-trim data-line-numbers><script type="text/template">
                            cmake_minimum_required(VERSION 3.21)
                            project(poly VERSION 1.2.3 LANGUAGES CXX)
                            # Import CMake testing support
                            include(CTest)
                            
                            # Define user options
                            option(POLY_INIT_NAN "Initialize all matrices and vectors to NaN for debugging purposes" Off)
                            
                            # Include the build script in the src directory
                            add_subdirectory("src")
                            # Include the build script in the test (if enabled)
                            if (BUILD_TESTING)
                                add_subdirectory("test")
                            endif()</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="6">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cpp" data-trim data-line-numbers="|3-6|10-15|17-37"><script type="text/template">
                            #pragma once

                            #include <Eigen/Dense>
                            #include <algorithm>
                            #include <initializer_list>
                            #include <utility>
                            
                            namespace poly {
                            
                            // Handy type aliases to make the rest of the code more readable.
                            using matrix_t = Eigen::MatrixX<double>;
                            using vector_t = Eigen::VectorX<double>;
                            using vector_ref_t = Eigen::Ref<const vector_t>;
                            using vector_mut_ref_t = Eigen::Ref<vector_t>;
                            using index_t = Eigen::Index;
                            
                            /// Representation of a polynomial in Chebyshev basis.
                            struct ChebyshevPolynomial {
                                /// Type of the polynomial coefficients.
                                using coeff_t = vector_t;
                            
                                /// Create an empty polynomial.
                                ChebyshevPolynomial() = default;
                                /// Create a polynomial with the given coefficients.
                                explicit ChebyshevPolynomial(coeff_t init_coeff)
                                    : coefficients {std::move(init_coeff)} {}
                                /// Create a polynomial with all zero coefficients of the given degree.
                                explicit ChebyshevPolynomial(index_t degree)
                                    : coefficients {coeff_t::Zero(degree + 1)} {}
                                /// Create a polynomial with the given coefficients.
                                ChebyshevPolynomial(std::initializer_list<double> init_coeff)
                                    : coefficients {init_coeff.size()} {
                                    std::ranges::copy(init_coeff, std::begin(this->coefficients));
                                }
                                /// Vector storing the polynomial coefficients in Chebyshev basis.
                                coeff_t coefficients;
                            };
                            
                            } // namespace poly</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="5">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                            #pragma once

                            #include <poly/poly.hpp>

                            namespace poly {

                            /// Given the vectors @f$ x @f$ and @f$ y @f$, interpolate a Chebyshev
                            /// polynomial @f$ p @f$ such that @f$ p(x_i) = y_i @f$.
                            /// @param  x   Samples of the independent variable.
                            /// @param  y   Samples of the dependent variable corresponding to @p x.
                            /// @pre    @p x and @p y should have the same length.
                            /// @return The coefficients of polynomial @f$ p @f$ in Chebyshev basis.
                            ChebyshevPolynomial interpolate_cheby(vector_ref_t x, vector_ref_t y);

                            } // namespace poly</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="8">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cpp" data-trim data-line-numbers="|8-19|22-34"><script type="text/template">
                            #include <Eigen/LU>
                            #include <cassert>
                            #include <poly/interpolate.hpp>

                            namespace poly {

                            namespace {
                            auto make_chebyshev_basis_matrix(vector_ref_t x, index_t degree) {
                                assert(degree >= 0);
                                const index_t N = x.size();
                                matrix_t V(N, degree + 1);
                                V.col(0) = vector_t::Ones(N);
                                if (degree >= 1) {
                                    V.col(1) = x;
                                    for (index_t i = 0; i < degree - 1; ++i)
                                        V.col(i + 2) = 2 * V.col(i + 1).cwiseProduct(x) - V.col(i);
                                }
                                return V;
                            }
                            } // namespace

                            ChebyshevPolynomial interpolate_cheby(vector_ref_t x, vector_ref_t y) {
                                assert(x.size() == y.size());
                                assert(x.size() > 0);
                                // Construct Vandermonde/basis matrix
                                auto V = make_chebyshev_basis_matrix(x, x.size() - 1);
                                // Scale the system
                                const vector_t scaling = V.colwise().norm().cwiseInverse();
                                V *= scaling.asDiagonal();
                                // Solve the system, undo scaling
                                vector_t solution = V.fullPivLu().solve(y);
                                solution.transpose() *= scaling.asDiagonal();
                                return solution;
                            }

                            } // namespace poly</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="9">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cmake" data-trim data-line-numbers="|1-2|3-8|9-10|11-12|13-14|15-18|"><script type="text/template">
                            # Find dependencies we rely on
                            find_package(Eigen3 REQUIRED)
                            # Define the "poly" library and specify the source files it consists of
                            add_library(poly
                                "include/poly/poly.hpp"
                                "include/poly/interpolate.hpp"
                                "src/interpolate.cpp"
                            )
                            # The library requires the 2020 revision of the C++ standard
                            target_compile_features(poly PUBLIC cxx_std_20)
                            # Specify the path of the header files
                            target_include_directories(poly PUBLIC "include")
                            # Link the Eigen library into our poly library
                            target_link_libraries(poly PUBLIC Eigen3::Eigen)
                            # Add custom compiler options or macros
                            if (POLY_INIT_NAN)
                                target_compile_definitions(poly PUBLIC EIGEN_INITIALIZE_MATRICES_BY_NAN)
                            endif()</script></code></pre>
                    </div>
                    <em class="fragment" style="margin-top: 2em; display: block;">Questions?</em>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="12">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                            #include <gtest/gtest.h>
                            #include <poly/interpolate.hpp>
                            #include <poly/poly.hpp>

                            TEST(poly, interpolateCheby) {
                                // Generate some arbitrary data vectors
                                const poly::index_t N = 5;
                                poly::vector_t x = poly::vector_t::LinSpaced(N, -1.0, 1.0);
                                poly::vector_t y(N);
                                y << 15.0, 3.5625, 1.0, 0.5625, 3.0;
                                // Interpolate the data
                                auto p = poly::interpolate_cheby(x, y);
                                // Check the coefficients of the interpolant
                                poly::ChebyshevPolynomial expected {4.375, -5.0, 4.0, -1.0, 0.625};
                                auto error = p.coefficients - expected.coefficients;
                                EXPECT_LE(error.norm(), 1e-12);
                            }</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Example project</h4>
                    <hr>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="11">
                            poly
                              ├── src
                              │   ├── include
                              │   │   └── poly
                              │   │       ├── interpolate.hpp
                              │   │       └── poly.hpp
                              │   ├── src
                              │   │   └── interpolate.cpp
                              │   └── CMakeLists.txt
                              ├── test
                              │   ├── CMakeLists.txt
                              │   └── test-interpolate.cpp
                              └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs cmake" data-trim data-line-numbers="|1-2|3-4|5-6|7-8|9-10"><script type="text/template">
                            # Import the Google Test CMake module
                            include(GoogleTest)
                            # Find the Google Test library
                            find_package(GTest REQUIRED)
                            # Build the test program
                            add_executable(tests "test-interpolate.cpp")
                            # The tests depend on the library under test, and on the Google Test framework
                            target_link_libraries(tests PRIVATE poly GTest::gtest_main)
                            # Let CMake/CTest discover the available tests
                            gtest_discover_tests(tests)</script></code></pre>
                    </div>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Example project: build commands</h4>
                    <hr>
                    <ul>
                        <li>Use Bash or Zsh shell on Linux/macOS, or in <em>“Visual Studio Developer PowerShell”</em> on
                            Windows</li>
                    </ul>

                    <pre data-id="cmake-build-poly"><code class="hljs bash" data-trim data-noescape data-line-numbers>
                        # Configure
                        cmake -S . -B build -G "Ninja Multi-Config" -D POLY_INIT_NAN=On
                        # Build
                        cmake --build build --config Debug -j
                        # Run tests
                        cmake --build build --config Debug --target test</code></pre>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Example project: build commands</h4>
                    <hr>
                    <pre data-id="cmake-build-poly"><code class="hljs bash" data-trim data-noescape data-line-numbers="1-12|14-19|21-30">
                        # Configure
                        cmake -S . -B build -G "Ninja Multi-Config" -D POLY_INIT_NAN=On
                        -- The CXX compiler identification is GNU 11.4.0
                        -- Detecting CXX compiler ABI info
                        -- Detecting CXX compiler ABI info - done
                        -- Check for working CXX compiler: /usr/bin/c++ - skipped
                        -- Detecting CXX compile features
                        -- Detecting CXX compile features - done
                        -- Found GTest: /usr/lib/x86_64-linux-gnu/cmake/GTest/GTestConfig.cmake (found version "1.11.0")  
                        -- Configuring done (0.5s)
                        -- Generating done (0.0s)
                        -- Build files have been written to: /home/pieter/GitHub/Cpp-Presentation/code/poly/build

                        # Build
                        cmake --build build --config Debug -j
                        [1/4] Building CXX object test/CMakeFiles/tests.dir/Debug/test-interpolate.cpp.o
                        [2/4] Building CXX object src/CMakeFiles/poly.dir/Debug/src/interpolate.cpp.o
                        [3/4] Linking CXX static library src/Debug/libpoly.a
                        [4/4] Linking CXX executable test/Debug/tests

                        # Run tests
                        cmake --build build --config Debug --target test
                        [0/1] Running tests...
                        Test project /home/pieter/GitHub/Cpp-Presentation/code/poly/build
                            Start 1: poly.interpolateCheby
                        1/1 Test #1: poly.interpolateCheby ............   Passed    0.00 sec
                        
                        100% tests passed, 0 tests failed out of 1
                        
                        Total Test time (real) =   0.00 sec</code></pre>
                </section>
                <section class="full">
                    <h4>Example project: Visual Studio Code</h4>
                    <video data-autoplay loop src="media/configure.mp4"></video>
                </section>
                <section class="full">
                    <h4>Example project: Visual Studio Code</h4>
                    <video data-autoplay loop src="media/test.mp4"></video>
                </section>
            </section>

            <section>
                <section id="sec-cmake">
                    <h3>CMake concepts</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>CMake concepts</h4>
                    <hr>
                    <ol>
                        <li>Import and define <span class="alert">targets</span>
                            <ul style="font-size: 0.66em;">
                                <li><code>find_package(name)</code></li>
                                <li><code>add_library(target sources...)</code></li>
                                <li><code>add_executable(target sources...)</code></li>
                                <li><code>add_custom_target(target command args...)</code></li>
                            </ul>
                        </li>
                        <li>Set target <span class="alert">properties</span> and <span class="alert">usage
                                requirements</span>
                            <ul style="font-size: 0.66em;">
                                <li><code>target_compile_features(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> features...)</code>
                                </li>
                                <li><code>target_compile_definitions(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> definitions...)</code>
                                </li>
                                <li><code>target_compile_options(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> options...)</code>
                                </li>
                                <li><code>target_include_directories(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> directories...)</code>
                                </li>
                                <li><code>target_link_options(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> options...)</code>
                                </li>
                                <li><code>set_target_properties(targets PROPERTIES property value)</code></li>
                            </ul>
                        </li>
                        <li>Express <span class="alert">dependencies</span> between targets
                            <ul style="font-size: 0.66em;">
                                <li><code>target_link_libraries(target <span class="fragment highlight-red" data-fragment-index="3">SCOPE</span> dependency)</code>
                                </li>
                            </ul>
                        </li>
                    </ol>
                    <ul class="arrow fragment" data-fragment-index="2">
                        <li>Use targets and properties, do not set global flags</li>
                    </ul>
                </section>

                <section class="full">
                    <h4>CMake concepts: scope and usage requirements</h4>
                    <hr>

                    <ul>
                        <li><b><code>PUBLIC</code></b>
                            <ul>
                                <li>Applies to current target <em>and</em> dependents <small
                                        class="rmrk">(transitive)</small></li>
                            </ul>
                        </li>
                        <li><b><code>PRIVATE</code></b>
                            <ul>
                                <li>Applies to current target <em>only</em></li>
                            </ul>
                        </li>
                        <li><b><code>INTERFACE</code></b>
                            <ul>
                                <li>Applies to dependents <em>only</em> <small class="rmrk">(transitive)</small></li>
                            </ul>
                        </li>
                    </ul>

                    <pre style="width: 70%; font-size: 0.7em; margin-top: 1em;" class="fragment"><code class="hljs cmake" data-trim data-line-numbers><script type="text/template">
                        add_library(liba ...)
                        target_compile_options(liba <SCOPE> "-flag")
                        add_library(libb ...)
                        target_link_libraries(libb PRIVATE liba)</script></code></pre>

                    <table class="fragment vertline" style="margin-top: 1em; font-size: 0.9em;">
                        <thead>
                            <tr>
                                <th></th>
                                <th><code>PUBLIC</code></th>
                                <th><code>PRIVATE</code></th>
                                <th><code>INTERFACE</code></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>liba</code></td>
                                <td><code>-flag</code></td>
                                <td><code>-flag</code></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td><code>libb</code></td>
                                <td><code>-flag</code></td>
                                <td></td>
                                <td><code>-flag</code></td>
                            </tr>
                        </tbody>
                    </table>
                    <small class="rmrk" style="font-size: 0.56em;"><a
                            href="https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html#target-usage-requirements">https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html#target-usage-requirements</a></small>
                </section>

                <section class="full">
                    <h4>CMake concepts: scope and usage requirements</h4>
                    <hr>
                    <ul>
                        <li>Reconsider the <code>poly</code> example from earlier:</li>
                    </ul>
                    <pre><code class="hljs cmake" data-trim data-line-numbers><script type="text/template">
                        # Find dependencies we rely on
                        find_package(Eigen3 REQUIRED)
                        # Define the "poly" library and specify the source files it consists of
                        add_library(poly
                            "include/poly/poly.hpp"
                            "include/poly/interpolate.hpp"
                            "src/interpolate.cpp"
                        )
                        # The library requires the 2020 revision of the C++ standard
                        target_compile_features(poly PUBLIC cxx_std_20)
                        # Specify the path of the header files
                        target_include_directories(poly PUBLIC "include")
                        # Link the Eigen library into our poly library
                        target_link_libraries(poly PUBLIC Eigen3::Eigen)
                        # Add custom compiler options or macros
                        if (POLY_INIT_NAN)
                            target_compile_definitions(poly PUBLIC EIGEN_INITIALIZE_MATRICES_BY_NAN)
                        endif()</script></code></pre>
                </section>

                <section class="full">
                    <h4>CMake concepts: scope and usage requirements</h4>
                    <hr>

                    <ul>
                        <li>Which scope to use for compiler <span class="alert">warnings</span>?
                            <ul style="font-size: 0.8em;">
                                <li>Want to apply them to our own code ...</li>
                                <li>... but not impose them on our users!</li>
                            </ul>
                            <ul class="arrow fragment">
                                <li style="margin-top: 0.25em;"><code>PRIVATE</code></li>
                            </ul>
                        </li>
                    </ul>

                    <pre style="font-size: 0.7em;" class="fragment"><code class="hljs cmake" data-trim data-line-numbers>
                        # Interface libraries have no source files, only compiler flags etc.
                        add_library(warnings INTERFACE)
                        # Add compiler warnings for GCC
                        if (CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
                            target_compile_options(warnings INTERFACE "-Wall" "-Wextra" "-pedantic")
                        endif()

                        # Create an actual library target
                        add_library(poly "src/interpolate.cpp" ...)
                        # Apply warnings only when building poly, not when building dependents
                        target_link_libraries(poly PRIVATE warnings)
                    
                        # This could be a user program that uses the poly library
                        add_executable(user_program "main.cpp")
                        # Compiled without warnings, thanks to private link between poly and warnings
                        target_link_libraries(user_program PRIVATE poly)</code></pre>
                </section>

                <section class="full">
                    <h4>CMake: further reading</h4>
                    <hr>
                    <ul>
                        <li>Variable scope and cache variables <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/book/mastering-cmake/chapter/CMake%20Cache.html">cmake.org/cmake/help/book/mastering-cmake/chapter/CMake
                                    Cache.html</a>)</small></li>
                        <li>Find modules and package configuration files <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/book/mastering-cmake/chapter/Finding%20Packages.html">cmake.org/cmake/help/book/mastering-cmake/chapter/Finding
                                    Packages.html</a>)</small></li>
                        <li>Variables, strings, lists <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/latest/manual/cmake-language.7.html">cmake.org/cmake/help/latest/manual/cmake-language.7.html</a>)</small>
                        </li>
                        <li>Export headers for shared libraries <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/latest/module/GenerateExportHeader.html">cmake.org/cmake/help/latest/module/GenerateExportHeader.html</a>)</small>
                        </li>
                        <li>Installation of files and targets <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/latest/command/install.html">cmake.org/cmake/help/latest/command/install.html</a>)</small>
                        </li>
                        <li>Packaging <br><small class="rmrk">(<a
                                    href="https://cmake.org/cmake/help/latest/manual/cpack.1.html">cmake.org/cmake/help/latest/manual/cpack.1.html</a>)</small>
                        </li>
                        <li>An Introduction to Modern CMake <br><small class="rmrk">(<a
                                    href="https://cliutils.gitlab.io/modern-cmake">cliutils.gitlab.io/modern-cmake</a>)</small>
                        </li>

                    </ul>
                </section>
            </section>

            <section>
                <section id="sec-pkg">
                    <h3>Package management</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>Package management: where to get dependencies</h4>
                    <hr>
                    <ul>
                        <li>System package manager <small class="rmrk">(APT, Homebrew, winget)</small>
                            <ul class="plus" style="font-size: 0.66em;">
                                <li>Easy</li>
                            </ul>
                            <ul class="min" style="font-size: 0.66em;">
                                <li>Requires admin privileges</li>
                                <li>No control over package version</li>
                            </ul>
                        </li>
                        <li>Build from source <small class="rmrk">(manually using shell scripts)</small>
                            <ul class="plus" style="font-size: 0.66em;">
                                <li>Precise control over version and options</li>
                                <li>No admin privileges required</li>
                            </ul>
                            <ul class="min" style="font-size: 0.66em;">
                                <li>Does not scale well for large dependency trees</li>
                                <li>Slow</li>
                            </ul>
                        </li>
                        <li>Include as Git submodule and CMake subdirectory <small class="rmrk">(using
                                <code>add_subdirectory</code>)</small>
                            <ul class="plus" style="font-size: 0.66em;">
                                <li>Dependencies are automatically built while building our own package</li>
                            </ul>
                            <ul class="min" style="font-size: 0.66em;">
                                <li>Similar drawbacks as above</li>
                            </ul>
                        </li>
                        <li>C++ package manager <small class="rmrk">(Vcpkg, Conan)</small>
                            <ul class="plus" style="font-size: 0.66em;">
                                <li>Simple declaration of required dependencies, features and versions</li>
                                <li>Good integration with CMake</li>
                                <li>Fast (binaries are often available)</li>
                                <li>Custom recipes, channels, repositories</li>
                            </ul>
                            <ul class="min" style="font-size: 0.66em;">
                                <li>Not all packages are available</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Package management: Conan</h4>
                    <hr>
                    <ul>
                        <li>List dependencies in <code>conanfile.txt</code> or <code>conanfile.py</code> file</li>
                        <li>Specify the <code>CMakeDeps</code> generator to make packages available using
                            <code>find_package</code>
                        </li>
                        <li>Specify the <code>CMakeToolchain</code> generator to pass options to CMake using a toolchain
                            file
                        </li>
                        <li>Choose the CMake layout for the build directories</li>
                    </ul>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="13">
                                poly
                                  ├── src
                                  │   ├── include
                                  │   │   └── poly
                                  │   │       ├── interpolate.hpp
                                  │   │       └── poly.hpp
                                  │   ├── src
                                  │   │   └── interpolate.cpp
                                  │   └── CMakeLists.txt
                                  ├── test
                                  │   ├── CMakeLists.txt
                                  │   └── test-interpolate.cpp
                                  ├── conanfile.txt
                                  └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
                                [requires]
                                eigen/3.4.0
                                [test_requires]
                                gtest/1.12.1
                                [generators]
                                CMakeDeps
                                CMakeToolchain
                                [layout]
                                cmake_layout</code></pre>
                    </div>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Package management: Conan</h4>
                    <hr>
                    <ul>
                        <li>Let Conan detect your system properties (only needed once)
                            <pre><code class="hljs bash" data-trim data-line-numbers>
                                conan profile detect --force</code></pre>
                        </li>
                        <li>Install dependencies of the <code>poly</code> project
                            <pre><code class="hljs bash" data-trim data-line-numbers>
                                conan install . # Default generator and default build type
                                conan install . \
                                    -c tools.cmake.cmaketoolchain:generator="Ninja" \
                                    -s build_type=Debug \
                                    --build=missing
                            </code></pre>
                        </li>
                        <li>Generate, build and test the project using CMake
                            <pre data-id="conan-cmake-build"><code class="hljs bash" data-trim data-line-numbers>
                                cmake --preset conan-debug          # Configure
                                cmake --build --preset conan-debug  # Build
                                ctest --preset conan-debug          # Run tests</code></pre>
                        </li>
                    </ul>
                    <div>
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://docs.conan.io/2/tutorial.html">https://docs.conan.io/2/tutorial.html</a></small>
                    </div>
                </section>

                <section class="full" data-auto-animate>
                    <h4>Package management: Conan</h4>
                    <hr>
                    <pre data-id="conan-cmake-build"><code class="hljs bash" data-trim data-noescape data-line-numbers="1-24|26-30|32-40">
                        cmake --preset conan-debug          # Configure
                        Preset CMake variables:
                        
                          CMAKE_BUILD_TYPE="Debug"
                          CMAKE_POLICY_DEFAULT_CMP0091="NEW"
                          CMAKE_TOOLCHAIN_FILE:FILEPATH="~/poly/build/Debug/generators/conan_toolchain.cmake"
                        
                        -- Using Conan toolchain: ~/poly/build/Debug/generators/conan_toolchain.cmake
                        -- Conan toolchain: C++ Standard 17 with extensions ON
                        -- The CXX compiler identification is GNU 11.4.0
                        -- Detecting CXX compiler ABI info
                        -- Detecting CXX compiler ABI info - done
                        -- Check for working CXX compiler: /usr/bin/c++ - skipped
                        -- Detecting CXX compile features
                        -- Detecting CXX compile features - done
                        -- Conan: Component target declared 'Eigen3::Eigen'
                        -- Conan: Component target declared 'GTest::gtest'
                        -- Conan: Component target declared 'GTest::gtest_main'
                        -- Conan: Component target declared 'GTest::gmock'
                        -- Conan: Component target declared 'GTest::gmock_main'
                        -- Conan: Target declared 'gtest::gtest'
                        -- Configuring done (0.3s)
                        -- Generating done (0.0s)
                        -- Build files have been written to: ~/poly/build/Debug

                        cmake --build --preset conan-debug  # Build
                        [1/4] Building CXX object test/CMakeFiles/tests.dir/Debug/test-interpolate.cpp.o
                        [2/4] Building CXX object src/CMakeFiles/poly.dir/Debug/src/interpolate.cpp.o
                        [3/4] Linking CXX static library src/Debug/libpoly.a
                        [4/4] Linking CXX executable test/Debug/tests

                        ctest --preset conan-debug          # Run tests
                        [0/1] Running tests...
                        Test project ~/poly/build
                            Start 1: poly.interpolateCheby
                        1/1 Test #1: poly.interpolateCheby ............   Passed    0.00 sec
                        
                        100% tests passed, 0 tests failed out of 1
                        
                        Total Test time (real) =   0.00 sec</code></pre>
                    <div>
                </section>
            </section>

            <section>
                <section id="sec-bugs">
                    <h3>Catching bugs early</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>Catching bugs early: compiler warnings</h4>
                    <hr>
                    <ul>
                        <li>GCC, Clang<ul>
                                <li><code>-Wall -Wextra -Wpedantic -pedantic-errors</code> absolute minimum</li>
                                <li>Many other useful warnings and diagnostics available<br>
                                    <small class="rmrk">(<a
                                            href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html">gcc.gnu.org/onlinedocs/gcc/Warning-Options.html</a>)</small><br>
                                    <small class="rmrk">(<a
                                            href="https://clang.llvm.org/docs/DiagnosticsReference.html">clang.llvm.org/docs/DiagnosticsReference.html</a>)</small>
                                </li>
                            </ul>
                        </li>
                        <li>MSVC<ul>
                                <li><code>/W3</code> absolute minimum, preferably <code>/W4</code><br>
                                    <small class="rmrk">(<a
                                            href="https://learn.microsoft.com/en-us/cpp/build/reference/compiler-option-warning-level">learn.microsoft.com/en-us/cpp/build/reference/compiler-option-warning-level</a>)</small>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: compiler warnings</h4>
                    <hr>
                    <ul>
                        <li>Start project with high warning level</li>
                        <li>Enable <em>warnings as errors</em> for development builds
                            <ul style="font-size: 0.7em;">
                                <li>GCC, Clang: <code>-Werror</code></li>
                                <li>MSVC: <code>/WX</code></li>
                            </ul>
                        </li>
                        <li>Enforce <em>zero warning policy</em> in continuous integration</li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: compiler warnings</h4>
                    <hr>
                    <ul>
                        <li>
                            Suppress unavoidable warnings locally using pragmas
                            <ul style="font-size: 0.7em;">
                                <li>GCC, Clang:<br>
                                    <small class="rmrk">(<a
                                            href="https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html">gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html</a>)</small><br>
                                    <small class="rmrk">(<a
                                            href="https://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-via-pragmas">clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-via-pragmas</a>)</small>
                                    <pre><code class="hljs cpp" data-trim data-line-numbers>
                                                #pragma GCC diagnostic push
                                                #pragma GCC diagnostic ignored "-Wxxx"
                                                /* code that would otherwise raise warning xxx */
                                                #pragma GCC diagnostic pop</code></pre>
                                </li>
                                <li>MSVC:<br>
                                    <small class="rmrk">(<a
                                            href="https://learn.microsoft.com/en-us/cpp/preprocessor/warning">learn.microsoft.com/en-us/cpp/preprocessor/warning</a>)</small>
                                    <pre><code class="hljs cpp" data-trim data-line-numbers>
                                        #pragma warning(push)
                                        #pragma warning(disable:xxxx)
                                        /* code that would otherwise raise warning xxxx */
                                        #pragma warning(pop)</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>Disable specific warnings if they raise too many false positives
                            <ul style="font-size: 0.7em;">
                                <li>GCC, Clang:<br>
                                    <code>-Wno-error=xxx</code> suppresses errors for warning <code>-Wxxx</code>,
                                    <code>-Wno-xxx</code> disables warning entirely<br>
                                    Use <code>-fdiagnostics-show-option</code> to include the warning name in the
                                    message
                                </li>
                                <li>MSVC:<br>
                                    <code>/wdxxxx</code> disables warning with code <code>xxxx</code>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: linting and static analysis</h4>
                    <hr>
                    <ul>
                        <li>
                            Clang-Tidy: Clang-based C++ “linter” tool <small class="rmrk">(<a
                                    href="https://clang.llvm.org/extra/clang-tidy">clang.llvm.org/extra/clang-tidy</a>)</small>
                            <ul style="font-size: 0.7em;">
                                <li>Diagnosing and fixing typical programming errors</li>
                                <li>Style violations</li>
                                <li>Static analysis</li>
                            </ul>
                        </li>
                        <li>
                            IDE integration <small class="rmrk">(recommended during development)</small>
                            <ul style="font-size: 0.7em;">
                                <li>Warning squiggles in editor</li>
                                <li>Automatic <em>quick fixes</em></li>
                            </ul>
                        </li>
                        <li>
                            CMake integration <small class="rmrk">(recommended for continuous integration)</small>
                            <ul style="font-size: 0.7em;">
                                <li>Use <code>-D CMAKE_CXX_CLANG_TIDY='clang-tidy;--warnings-as-errors=*'</code> <small
                                        class="rmrk">(<a
                                            href="https://cmake.org/cmake/help/latest/variable/CMAKE_LANG_CLANG_TIDY.html">cmake.org/cmake/help/latest/variable/CMAKE_LANG_CLANG_TIDY.html</a>)</small>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: linting and static analysis</h4>
                    <hr>
                    <ul>
                        <li>
                            Clang-Tidy: configuration file
                            <ul style="font-size: 0.7em;">
                                <li>Like warnings, enable the majority of checks in the beginning</li>
                                <li>Remove checks for stylistic rules you don't follow (using minus sign)</li>
                                <li>Suppress false positives locally using <code>NOLINT(name-of-check)</code> comments
                                </li>
                                <li>Disable checks that generate too many false positives</li>
                                <li>Don't forget <code>HeaderFilterRegex</code> so it also checks your header files!
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="13">
                                poly
                                  ├── src
                                  │   ├── include
                                  │   │   └── poly
                                  │   │       ├── interpolate.hpp
                                  │   │       └── poly.hpp
                                  │   ├── src
                                  │   │   └── interpolate.cpp
                                  │   └── CMakeLists.txt
                                  ├── test
                                  │   ├── CMakeLists.txt
                                  │   └── test-interpolate.cpp
                                  ├── .clang-tidy
                                  ├── conanfile.txt
                                  └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs yaml" data-trim data-line-numbers>
                            ---
                            WarningsAsErrors: ''
                            HeaderFilterRegex: '(include/poly)'
                            FormatStyle: file
                            
                            Checks: |
                                *,
                                -abseil*,-altera*,-android*,-fuchsia*,-google*,-llvm*,-zircon*,
                                -modernize-use-trailing-return-type,
                                -*-magic-numbers,
                                google-build-using-namespace,
                            
                            CheckOptions:
                                - key: readability-implicit-bool-conversion.AllowPointerConditions
                                  value: true</code></pre>
                    </div>
                </section>


                <section class="full">
                    <h4>Catching bugs early: linting and static analysis</h4>
                    <hr>
                    <ul>
                        <li>Other tools:<ul>
                                <li>GCC’s built-in <code>-fanalyzer</code> option<br><small class="rmrk">(<a
                                            href="https://gcc.gnu.org/onlinedocs/gcc/Static-Analyzer-Options.html">gcc.gnu.org/onlinedocs/gcc/Static-Analyzer-Options.html</a>)</small>
                                </li>
                                <li>Cppcheck<br><small class="rmrk">(<a
                                            href="https://github.com/danmar/cppcheck">github.com/danmar/cppcheck</a>)</small>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: Undefined Behavior</h4>
                    <hr>
                    <ul>
                        <li>What is the result of compiling and running the following code?
                            <ol style="list-style-type: upper-alpha; padding-left: 1em;">
                                <li>Compilation error</li>
                                <li>Program runs but does not terminate</li>
                                <li>Program runs but corrupts the hard drive</li>
                                <li>Program runs and terminates immediately after printing <em>Launching the nukes
                                        ...</em></li>
                            </ol>
                            <ul class="arrow fragment">
                                <li>Any of the above! <small class="rmrk">(B. using GCC, D. using Clang)</small></li>
                            </ul>
                        </li>
                    </ul>
                    <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                            #include <cstdio>

                            int main() {
                                while (true)
                                    ; // nothing
                            }

                            void launch_the_nukes() {
                                std::puts("Launching the nukes ...");
                            }</script></code></pre>
                </section>

                <section class="full">
                    <h4>Catching bugs early: Undefined Behavior</h4>
                    <hr>
                    <ul>
                        <li>
                            Undefined Behavior (UB) is a violation of language rules and compiler’s preconditions
                            <ul class="arrow">
                                <li style="margin-top: 0.2em;">No guarantees about the output of the compiler!</li>
                                <li style="margin-top: 0;">Runtime crash (e.g. segmentation fault) <small
                                        class="rmrk">(best outcome)</small>
                                </li>
                                <li style="margin-top: 0;">Bug lies dormant, program appears to do what you
                                    expected <small class="rmrk">(can change at any time!)</small></li>
                                <li style="margin-top: 0;">Program runs without crashing, silently generates incorrect
                                    results or has security
                                    vulnerability<small class="rmrk">(worst outcome)</small></li>
                            </ul>
                        </li>
                        <li style="margin-top: 0.5em;">Many different sources:
                            <ul style="font-size: 0.7em;">
                                <li>Uninitialized variables</li>
                                <li>Array out of bounds</li>
                                <li>Signed integer overflow</li>
                                <li>Pointer casts</li>
                                <li>Data races</li>
                                <li>Null pointer dereference</li>
                                <li>Use after free</li>
                                <li>...</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: preventing Undefined Behavior</h4>
                    <hr>
                    <ul>
                        <li>How to prevent and detect Undefined Behavior?
                            <ol style="padding-left: 1em;">
                                <li>Awareness: know the rules of the language <small class="rmrk">(<a
                                            href="https://en.cppreference.com">en.cppreference.com</a>)</small></li>
                                <li>Follow good coding practices <small class="rmrk">(<a
                                            href="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines.html">isocpp.github.io/CppCoreGuidelines</a>)</small>
                                </li>
                                <li>Compiler warnings, linters and static analysis <small class="rmrk">(previous
                                        slides)</small></li>
                                <li>Run-time instrumentation and sanitizers <small class="rmrk">(following
                                        slides)</small></li>
                                <li>Run in specialized virtual machine like Valgrind <small class="rmrk">(<a
                                            href="https://valgrind.org/">valgrind.org</a>)</small></li>
                            </ol>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Catching bugs early: preventing Undefined Behavior</h4>
                    <hr>
                    <ul>
                        <li>Address Sanitizer <small class="rmrk">(<code>-fsanitize=address</code>)</small>
                            <ul>
                                <li>Checks for memory errors (use after free, array out of bounds,
                                    dangling pointers)</li>
                            </ul>
                        </li>
                        <li>Undefined Behavior Sanitizer <small class="rmrk">(<code>-fsanitize=undefined</code>)</small>
                            <ul>
                                <li>Checks for things like integer overflow, null pointer dereference, division by zero,
                                    pointer misalignment, invalid vpointers</li>
                            </ul>
                        </li>
                        <li>Thread Sanitizer <small class="rmrk">(<code>-fsanitize=thread</code>)</small>
                            <ul>
                                <li>Checks for data races</li>
                            </ul>
                            <ul class="arrow">
                                <li>Sanitizers do not catch 100% of errors!</li>
                            </ul>
                        </li>
                    </ul>

                    <div style="margin-top: 1em;">
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html">https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html</a></small><br>
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://clang.llvm.org/docs/AddressSanitizer.html">https://clang.llvm.org/docs/AddressSanitizer.html</a></small><br>
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html">https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html</a></small><br>
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://clang.llvm.org/docs/ThreadSanitizer.html">https://clang.llvm.org/docs/ThreadSanitizer.html</a></small><br>
                        <small class="rmrk" style="font-size: 0.56em;"><a
                                href="https://learn.microsoft.com/en-us/cpp/sanitizers/asan">https://learn.microsoft.com/en-us/cpp/sanitizers/asan</a></small>
                    </div>
                </section>

                <section class="full">
                    <h4>Catching bugs <s>early</s> <em>a bit later</em>: debugging</h4>
                    <hr>
                    <ul>
                        <li>Debuggers are extremely powerful tools</li>
                        <li>Many different front-ends and display modes <small class="rmrk">(e.g <code>GDB TUI</code>
                                layout)</small></li>
                        <li>Python scripting and pretty-printing <small class="rmrk">(<a
                                    href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Basic-Python.html">GDB
                                    Python API</a>)</small></li>
                        <li>Conditional break-points</li>
                        <li>Hardware watchpoints to break when a memory location is accessed <small class="rmrk">(<a
                                    href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Set-Watchpoints.html">GDB
                                    watch</a>)</small></li>
                        <li>Remote debugging over SSH</li>
                        <li>Post-mortem analysis and reverse stepping <small class="rmrk">(<a
                                    href="https://rr-project.org/">rr-project.org</a>)</small></li>
                        <li>Instruction-level debugging and disassembly</li>
                        <li>...</li>
                    </ul>
                </section>
            </section>

            <section>
                <section id="sec-practices">
                    <h3>Best practices</h3>
                    <hr>
                </section>

                <section class="full">
                    <h4>Best practices: C++ Core Guidelines</h4>
                    <hr>
                    <ul>
                        <li>C++ Core Guidelines <small class="rmrk">(<a
                                    href="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines.html">isocpp.github.io/CppCoreGuidelines</a>)</small>
                        </li>
                    </ul>
                </section>

                <section class="full"
                    data-background-iframe="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines.html"
                    data-background-interactive>
                </section>

                <section class="full">
                    <h4>Best practices: version control</h4>
                    <hr>
                    <ul>
                        <li>Use Git for version control<ul>
                                <li>KU Leuven has a GitLab instance <small class="rmrk">(<a
                                            href="https://gitlab.kuleuven.be/">gitlab.kuleuven.be</a>)</small></li>
                                <li>GitHub offers free Pro subscriptions for students <small class="rmrk">(<a
                                            href="https://github.com/">github.com</a>)</small></li>
                                <li>Commit often</li>
                                <li>Pull and rebase often</li>
                                <li>Use meaningful commit messages</li>
                                <li>Ignore large files, caches, temporary build files etc. using <code>.gitignore</code>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Best practices: formatting</h4>
                    <hr>
                    <ul>
                        <li>
                            Clang-Format: automatic code formatter
                            <ul style="font-size: 0.7em;">
                                <li>Built-in IDE support</li>
                                <li>Always format before committing</li>
                                <li>Minimizes uninteresting changes in Git diffs</li>
                            </ul>
                        </li>
                    </ul>
                    <div style="display: flex; gap: 0.5em;">
                        <pre style="flex: 30%; font-size: 0.5em;"><code class="hljs text no-ln" data-trim data-noescape data-line-numbers="13">
                                poly
                                  ├── src
                                  │   ├── include
                                  │   │   └── poly
                                  │   │       ├── interpolate.hpp
                                  │   │       └── poly.hpp
                                  │   ├── src
                                  │   │   └── interpolate.cpp
                                  │   └── CMakeLists.txt
                                  ├── test
                                  │   ├── CMakeLists.txt
                                  │   └── test-interpolate.cpp
                                  ├── .clang-format
                                  ├── .clang-tidy
                                  ├── conanfile.txt
                                  └── CMakeLists.txt</code></pre>
                        <pre style="flex: 70%" data-id="code-animation"><code class="hljs yaml" data-trim data-line-numbers style="max-height: 500px;"><script type="text/template">
                            ---
                            Language:        Cpp
                            AccessModifierOffset: -2
                            AlignAfterOpenBracket: Align
                            AlignConsecutiveMacros: false
                            AlignConsecutiveAssignments: true
                            AlignConsecutiveDeclarations: false
                            AlignEscapedNewlines: Right
                            AlignOperands: true
                            AlignTrailingComments: true
                            AllowAllArgumentsOnNextLine: true
                            AllowAllConstructorInitializersOnNextLine: true
                            AllowAllParametersOfDeclarationOnNextLine: true
                            AllowShortBlocksOnASingleLine: Never
                            AllowShortCaseLabelsOnASingleLine: true
                            AllowShortFunctionsOnASingleLine: All
                            AllowShortLambdasOnASingleLine: All
                            AllowShortIfStatementsOnASingleLine: Never
                            AllowShortLoopsOnASingleLine: false
                            AlwaysBreakAfterDefinitionReturnType: None
                            AlwaysBreakAfterReturnType: None
                            AlwaysBreakBeforeMultilineStrings: false
                            AlwaysBreakTemplateDeclarations: true
                            BinPackArguments: true
                            BinPackParameters: true
                            BraceWrapping:
                              AfterCaseLabel:  false
                              AfterClass:      false
                              AfterControlStatement: false
                              AfterEnum:       false
                              AfterFunction:   false
                              AfterNamespace:  false
                              AfterObjCDeclaration: false
                              AfterStruct:     false
                              AfterUnion:      false
                              AfterExternBlock: false
                              BeforeCatch:     false
                              BeforeElse:      false
                              IndentBraces:    false
                              SplitEmptyFunction: true
                              SplitEmptyRecord: true
                              SplitEmptyNamespace: true
                            BreakBeforeBinaryOperators: None
                            BreakBeforeBraces: Attach
                            BreakBeforeInheritanceComma: false
                            BreakInheritanceList: BeforeColon
                            BreakBeforeTernaryOperators: true
                            BreakConstructorInitializersBeforeComma: false
                            BreakConstructorInitializers: BeforeColon
                            BreakAfterJavaFieldAnnotations: false
                            BreakStringLiterals: true
                            ColumnLimit:     80
                            CommentPragmas:  '^ IWYU pragma:'
                            CompactNamespaces: false
                            ConstructorInitializerAllOnOneLineOrOnePerLine: false
                            ConstructorInitializerIndentWidth: 4
                            ContinuationIndentWidth: 4
                            Cpp11BracedListStyle: true
                            DeriveLineEnding: true
                            DerivePointerAlignment: false
                            DisableFormat:   false
                            ExperimentalAutoDetectBinPacking: false
                            FixNamespaceComments: true
                            ForEachMacros:
                              - foreach
                              - Q_FOREACH
                              - BOOST_FOREACH
                            IncludeBlocks:   Preserve
                            IncludeCategories:
                              - Regex:           '^<poly/.*'
                                Priority:        10
                              - Regex:           '^".*'
                                Priority:        20
                              - Regex:           '^".+/.*'
                                Priority:        30
                              - Regex:           '^<.+/.*'
                                Priority:        40
                              - Regex:           '^<.*\.h>'
                                Priority:        50
                              - Regex:           '^<.*'
                                Priority:        60
                            IncludeIsMainRegex: '(Test)?$'
                            IncludeIsMainSourceRegex: ''
                            IndentCaseLabels: true
                            IndentGotoLabels: true
                            IndentPPDirectives: None
                            IndentWidth:     4
                            IndentWrappedFunctionNames: false
                            JavaScriptQuotes: Leave
                            JavaScriptWrapImports: true
                            KeepEmptyLinesAtTheStartOfBlocks: true
                            MacroBlockBegin: ''
                            MacroBlockEnd:   ''
                            MaxEmptyLinesToKeep: 1
                            NamespaceIndentation: None
                            ObjCBinPackProtocolList: Auto
                            ObjCBlockIndentWidth: 2
                            ObjCSpaceAfterProperty: false
                            ObjCSpaceBeforeProtocolList: true
                            PenaltyBreakAssignment: 2
                            PenaltyBreakBeforeFirstCallParameter: 19
                            PenaltyBreakComment: 300
                            PenaltyBreakFirstLessLess: 120
                            PenaltyBreakString: 1000
                            PenaltyBreakTemplateDeclaration: 10
                            PenaltyExcessCharacter: 1000000
                            PenaltyReturnTypeOnItsOwnLine: 60
                            PointerAlignment: Right
                            QualifierAlignment: Custom
                            QualifierOrder: [inline, static, constexpr, const, volatile, type]
                            ReflowComments:  false
                            SortIncludes:    true
                            SortUsingDeclarations: true
                            SpaceAfterCStyleCast: false
                            SpaceAfterLogicalNot: false
                            SpaceAfterTemplateKeyword: true
                            SpaceBeforeAssignmentOperators: true
                            SpaceBeforeCpp11BracedList: false
                            SpaceBeforeCtorInitializerColon: true
                            SpaceBeforeInheritanceColon: true
                            SpaceBeforeParens: ControlStatements
                            SpaceBeforeRangeBasedForLoopColon: true
                            SpaceInEmptyBlock: false
                            SpaceInEmptyParentheses: false
                            SpacesBeforeTrailingComments: 1
                            SpacesInAngles:  false
                            SpacesInConditionalStatement: false
                            SpacesInContainerLiterals: true
                            SpacesInCStyleCastParentheses: false
                            SpacesInParentheses: false
                            SpacesInSquareBrackets: false
                            SpaceBeforeSquareBrackets: false
                            Standard:        c++20
                            StatementMacros:
                              - Q_UNUSED
                              - QT_REQUIRE_VERSION
                            TabWidth:        4
                            UseCRLF:         false
                            UseTab:          Never
                            ...</script></code></pre>
                    </div>
                </section>

                <section class="full">
                    <h4>Best practices: documentation</h4>
                    <hr>
                    <ul>
                        <li>Use a documentation generation tool <ul style="font-size: 0.8em;">
                                <li>Doxygen <small class="rmrk">(<a
                                            href="https://www.doxygen.nl/">www.doxygen.nl</a>)</small></li>
                                <li>Sphinx <small class="rmrk">(<a
                                            href="https://www.sphinx-doc.org">www.sphinx-doc.org</a>, <a
                                            href="https://breathe.readthedocs.io">breathe.readthedocs.io</a>)</small>
                                </li>
                            </ul>
                        </li>
                        <li>Document functions and variables using Doxygen-style docstrings <small class="rmrk">(<a
                                    href="https://www.doxygen.nl/manual/docblocks.html">www.doxygen.nl/manual/docblocks.html</a>)</small>
                            <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                                        /// Given the vectors @f$ x @f$ and @f$ y @f$, interpolate a Chebyshev
                                        /// polynomial @f$ p @f$ such that @f$ p(x_i) = y_i @f$.
                                        /// @param  x   Samples of the independent variable.
                                        /// @param  y   Samples of the dependent variable corresponding to @p x.
                                        /// @pre    @p x and @p y should have the same length.
                                        /// @return The coefficients of polynomial @f$ p @f$ in Chebyshev basis.
                                        ChebyshevPolynomial interpolate_cheby(vector_ref_t x, vector_ref_t y);</script></code></pre>
                        </li>
                        <li>Use comments to explain <em>why</em> a piece of code is necessary and <em>how</em> it
                            achieves its task,<br>do not simply repeat <em>what</em> the code does</li>
                        <li>Docstrings and API references are insufficient <ul style="font-size: 0.8em;">
                                <li>Include high-level documentation that explains core concepts and overall
                                    architecture</li>
                            </ul>
                        </li>
                        <li>Include examples</li>
                    </ul>
                </section>

                <section class="full">
                    <h4>Best practices: continuous integration</h4>
                    <hr>
                    <ul>
                        <li>Continuous integration: Run checks and tests every time you push code
                            <ul style="font-size: 0.9em;">
                                <li>GitHub Actions <small class="rmrk">(<a
                                            href="https://docs.github.com/en/actions">docs.github.com/en/actions</a>)</small>
                                </li>
                                <li>GitLab CI/CD <small class="rmrk">(<a
                                            href="https://docs.gitlab.com/ee/ci/">docs.gitlab.com/ee/ci</a>)</small>
                                </li>
                            </ul>
                        </li>
                        <li>
                            Useful for:
                            <ul style="font-size: 0.9em;">
                                <li>Running automated tests</li>
                                <li>Checking formatting, running static analysis, checking warnings</li>
                                <li>Generating code coverage reports</li>
                                <li>Generating and deploying documentation</li>
                                <li>Building, packaging and releasing software</li>
                                <li>...</li>
                            </ul>
                        </li>
                        <li>
                            Matrix builds: build and test different combinations of settings and environments <small
                                class="rmrk">(<a
                                    href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs">docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs</a>)</small>
                        </li>
                        <li>
                            Docker: reproducible builds <small class="rmrk">(<a
                                    href="https://docs.docker.com/">docs.docker.com</a>)</small>
                        </li>
                    </ul>
                </section>
            </section>

            <section>
                <section id="sec-optimization">
                    <h3>Optimization</h3>
                    <hr>
                </section>
                <section class="full">
                    <h4>Optimization</h4>
                    <hr>
                    <ul>
                        <li><em>“Premature optimization is the root of all evil”</em>
                            <ul class="arrow">
                                <li>Measure!</li>
                            </ul>
                        </li>
                    </ul>
                    <div>
                        <img height="540" data-src="https://imgs.xkcd.com/comics/optimization.png"
                            alt="Premature optimization is the root of all evil, so to start this project I'd better come up with a system that can determine whether a possible optimization is premature or not."><br>
                        <small class="rmrk" style="font-size: 0.56em;">(<a
                                href="https://xkcd.com/1691/">xkcd.com/1691</a>)</small><br>
                    </div>
                </section>
                <section class="full">
                    <h4>Optimization</h4>
                    <hr>
                    <ul>
                        <li>Profiling and performance tools
                            <ul style="font-size: 0.8em;">
                                <li>gprof <small class="rmrk">(profile analysis, <a
                                            href="https://sourceware.org/binutils/docs/gprof/">sourceware.org/binutils/docs/gprof</a>)</small>
                                </li>
                                <li>Valgrind callgrind <small class="rmrk">(CPU and cache profiler, <a
                                            href="https://valgrind.org/docs/manual/cl-manual.html">valgrind.org/docs/manual/cl-manual.html</a>)</small>
                                </li>
                                <li>Valgrind massif <small class="rmrk">(memory profiler, <a
                                            href="https://valgrind.org/docs/manual/ms-manual.html">valgrind.org/docs/manual/ms-manual.html</a>)</small>
                                </li>
                                <li>KCachegrind <small class="rmrk">(profile visualization, <a
                                            href="https://github.com/KDE/kcachegrind">github.com/KDE/kcachegrind</a>)</small>
                                </li>
                                <li>Intel VTune <small class="rmrk">(commercial profiler)</small></li>
                                <li>Google Benchmark <small class="rmrk">(micro-benchmarking framework, <a
                                            href="https://github.com/google/benchmark">github.com/google/benchmark</a>
                                        )</small></li>
                                <li>QuickBench <small class="rmrk">(online version of
                                        Google Benchmark, <a
                                            href="https://quick-bench.com/">quick-bench.com</a>)</small></li>
                                <li>Compiler Explorer <small class="rmrk">(shows generated
                                        assembly, <a href="https://godbolt.org/">godbolt.org</a>)</small></li>
                            </ul>
                        </li>
                    </ul>
                </section>
                <section class="full" data-background-iframe="https://godbolt.org/z/cah8d3PsP"
                    data-background-interactive>
                </section>

                <section class="full">
                    <h4>Optimization: performance tips</h4>
                    <hr>
                    <ul>
                        <li>Build in <code>Release</code> mode (with optimizations enabled)</li>
                        <li>Compile for a modern CPU, e.g. <code>-march=native</code>, to get SSE/AVX support</li>
                        <li>Enable link-time optimization (LTO) <small
                                class="rmrk">(<code>CMAKE_INTERPROCEDURAL_OPTIMIZATION=On</code>)</small></li>
                        <li>Use profile-guided optimization (PGO)</li>
                        <li>Use vendor-optimized libraries for math, linear algebra, FFT, MPI, threading ...</li>
                        <li>If <code>Debug</code> mode is slow, use <code>-Og</code> instead of <code>-O0</code></li>
                        <li>Beware of hidden costs (e.g. allocation) in tight loops</li>
                        <li>Design with cache locality and arithmetic intensity in mind</li>
                        <li>Eigen expression templates are faster than naive loops</li>
                        <li>Don't guess, measure!</li>
                    </ul>
                </section>
            </section>

            <section>
                <section id="sec-interop">
                    <h3>Interoperability with Python</h3>
                    <hr>
                </section>
                <section class="full">
                    <h4>Interoperability with Python</h4>
                    <hr>
                    <ul>
                        <li><code>pybind11</code> <small class="rmrk">(<a
                                    href="https://github.com/pybind/pybind11">github.com/pybind/pybind11</a>)</small>
                        </li>
                        <li><code>nanobind</code> <small class="rmrk">(<a
                                    href="https://github.com/wjakob/nanobind">github.com/wjakob/nanobind</a>)</small>
                        </li>
                        <li>Call fast C++ algorithms from Python</li>
                        <li>Call handy Python functions from C++</li>
                        <li>Expose C++ functions and classes to Python</li>
                        <li>Automatic conversions between NumPy arrays and Eigen matrices/vectors</li>
                        <li>For example: <ol style="font-size: 0.8em; padding-left: 1em;">
                                <li>Load or generate data using <code>pandas</code> or <code>scikit-learn</code></li>
                                <li>Call fast C++ function that implements the main algorithm</li>
                                <li>Process the results and plot using <code>matplotlib</code></li>
                            </ol>
                        </li>
                        <li>Create a Python package out of a CMake project using <code>py-build-cmake</code> <small
                                class="rmrk">(<a
                                    href="https://github.com/tttapa/py-build-cmake">github.com/tttapa/py-build-cmake</a>)</small>
                        </li>
                    </ul>
                </section>
                <section class="full">
                    <h4>Interoperability with Python</h4>
                    <hr>
                    <pre><code class="hljs cpp" data-trim data-line-numbers="|5-7|9-17"><script type="text/template">
                       #include <cstdint>
                       #include <pybind11/pybind11.h>
                       using namespace pybind11::literals;
                       
                       int32_t add(int32_t a, int32_t b) {
                           return a + b;
                       }
                       
                       PYBIND11_MODULE(MODULE_NAME, m) {
                           m.doc()               = "Module for adding integers";
                           m.attr("__version__") = VERSION_INFO;
                           m.def("add",              // function name in Python
                                 add,                // C++ function
                                 "a"_a, "b"_a,       // Argument names in Python
                                 "Adds two integers" // Docstring in Python
                           );
                       }</script></code></pre>
                </section>
            </section>

            <section>
                <section id="sec-rsrc">
                    <h3>Useful resources</h3>
                    <hr>
                </section>
                <section class="full">
                    <h4>Useful resources</h4>
                    <hr>
                    <ul>
                        <li>C++ tutorial: <a href="https://www.learncpp.com">www.learncpp.com</a></li>
                        <li>Language and standard library reference for C and C++: <a
                                href="https://en.cppreference.com/w/cpp/">en.cppreference.com</a></li>
                        <li><a href="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines">C++ Core
                                Guidelines</a>: an extensive set of guidelines for using C++ well</li>
                        <li><a href="https://open-std.org/jtc1/sc22/wg21/docs/papers/2023/n4950.pdf">C++ 23 Standard
                                (draft)</a>: draft of the official C++ standard, as a big PDF</li>
                        <li>CppCon Back to Basics: excellent conference talks about specific subjects (<a
                                href="https://www.youtube.com/watch?v=Bt3zcJZIalk&list=PLHTh1InhhwT4TJaHBVWzvBOYhp27UO7mI">2021</a>)
                            (<a
                                href="https://www.youtube.com/watch?v=ZAji7PkXaKY&list=PLHTh1InhhwT5o3GwbFYy3sR7HDNRA353e">2020</a>)
                        </li>
                        <li>Various interesting conference talks: <a
                                href="https://www.youtube.com/user/CppCon">CppCon</a>, <a
                                href="https://www.youtube.com/@BoostCon">C++Now</a>, <a
                                href="https://www.youtube.com/@cpponsea2834">CppOnSea</a>, <a
                                href="https://www.youtube.com/@cppnorth">CppNorth</a>
                        </li>
                        <li>C++ Weekly with Jason Turner: <a
                                href="https://www.youtube.com/@cppweekly">www.youtube.com/@cppweekly</a></li>
                        <li><a href="https://cliutils.gitlab.io/modern-cmake">An Introduction to Modern CMake</a></li>
                        <li><a href="https://learn.scientific-python.org/development/">Scientific Python Library
                                Development Guide</a></li>
                    </ul>
                </section>
            </section>

            <section>
                <section>
                    <h3>Recap</h3>
                    <hr>
                </section>
                <section class="full">
                    <h4>Recap</h4>
                    <hr>
                    <ul>
                        <li>Use a build system generator and package manager to make installation as frictionless as
                            possible <small class="rmrk">(e.g. CMake + Conan)</small></li>
                        <li>Beware Undefined Behavior</li>
                        <li>Keep up with best practices</li>
                        <li>Enable compiler warnings and static analysis <small class="rmrk">(e.g. Clang-Tidy)</small>
                        </li>
                        <li>Use continuous integration for running tests (with sanitizers and Valgrind)</li>
                        <li>Include good documentation and examples</li>
                        <li>Don't get lost in micro-optimizations</li>
                    </ul>
                    <div style="margin-top: 3em;">
                        <a
                            href="https://github.com/tttapa/Mastering-Cpp-Scientific-Computing">https://github.com/tttapa/Mastering-Cpp-Scientific-Computing</a>
                    </div>
                </section>
            </section>
        </div>

    </div>

    <script src="node_modules/reveal.js/dist/reveal.js"></script>
    <script src="node_modules/reveal.js/plugin/zoom/zoom.js"></script>
    <script src="node_modules/reveal.js/plugin/notes/notes.js"></script>
    <script src="node_modules/reveal.js/plugin/search/search.js"></script>
    <script src="node_modules/reveal.js/plugin/markdown/markdown.js"></script>
    <script src="node_modules/reveal.js/plugin/highlight/highlight.js"></script>
    <script>

        // Also available as an ES module, see:
        // https://revealjs.com/initialization/
        Reveal.initialize({
            controls: true,
            progress: true,
            center: true,
            hash: true,

            // The "normal" size of the presentation, aspect ratio will
            // be preserved when the presentation is scaled to fit different
            // resolutions. Can be specified using percentage units.
            width: 960 * 1.5,
            height: 600 * 1.5,
            // height: 540 * 1.6,

            // Factor of the display size that should remain empty around
            // the content
            margin: 0.04,

            // Bounds for smallest/largest possible scale to apply to content
            minScale: 0.2,
            maxScale: 2.0,

            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
        });

    </script>

</body>

</html>